<!DOCTYPE html>
<html lang="ko">
<head>
<style>
/* ... (ì´ì „ê³¼ ë™ì¼í•œ CSS ìŠ¤íƒ€ì¼) ... */
</style>
</head>
<body>
<div class="container">
<form id="carForm"
action="https://docs.google.com/forms/u/0/d/e/1FAIpQLSdKRsd3rMQuJ9dGMS4PRTVueYEbkZs5ajfAqO8Gni5RUsUdDw/formResponse"
method="POST"
target="hidden_iframe">
<input type="hidden" id="phoneHidden" name="entry.1863849812" value="">
<input type="hidden" id="carNumberHidden" name="entry.439516004" value="">
<input type="hidden" id="consentHidden" name="entry.1323416282" value="" required>
<input type="hidden" name="entry.846846420" id="licensePriceHidden">
<div class="step active" id="step1">
Â Â Â Â </div>

<div class="step" id="step2">
Â Â Â Â </div>

</form>
</div>
<iframe name="hidden_iframe" id="hidden_iframe"
style="display:none;"
onload="if(submitted) { console.log('Google Formsë¡œ ë°ì´í„° ì „ì†¡ ì™„ë£Œ! (ì‹¤ì œ ì „ì†¡ì€ iframeì—ì„œ ì²˜ë¦¬)'); alert('íƒì‹œë©´í—ˆ íŒë§¤í¬ë§ ê°€ê²© ë“±ë¡ ë° ì•Œë¦¼ ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.'); window.location='https://licenseprice.licen.co.kr/thankyou.html'; }" ></iframe>
<script>
let currentStep = 1;
const totalSteps = 2;
let submitted = false;

// 1ë‹¨ê³„ í•„ë“œ
const licensePriceInput = document.getElementById('licensePriceInput');
const licensePriceHidden = document.getElementById('licensePriceHidden');


// 2ë‹¨ê³„ í•„ë“œ
const nameInput = document.getElementById('name');
const phoneInput = document.getElementById('phone');
const phoneHidden = document.getElementById('phoneHidden');
const carNumPart1 = document.getElementById('carNumPart1');
const carNumPart2 = document.getElementById('carNumPart2');
const carHangulSelect = document.getElementById('carHangulSelect');
const carNumberHidden = document.getElementById('carNumberHidden');
const consentCheckbox = document.getElementById('consent');
const consentHidden = document.getElementById('consentHidden');


/**
* í•„ë“œ ê°’ì´ ì™„ë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê³  ë°°ê²½ìƒ‰ì„ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
* @param {HTMLElement} element - ì…ë ¥ ë˜ëŠ” ì„ íƒ í•„ë“œ ìš”ì†Œ.
*/
function checkCompletion(element) {
let isCompleted = false;

if (element.tagName === 'INPUT') {
if (element.id === 'phone') {
const phoneValue = element.value.replace(/[^0-9]/g, '');
isCompleted = phoneValue.length === 8;
} else if (element.id === 'carNumPart1') {
isCompleted = element.value.trim().length === 2;
} else if (element.id === 'carNumPart2') {
isCompleted = element.value.trim().length === 4;
} else if (element.id === 'name') {
isCompleted = element.value.trim() !== '';
} else if (element.id === 'licensePriceInput') {
// ìµœëŒ€ 4ìë¦¬ ê²€ì¦
isCompleted = element.value.trim() !== '' && !isNaN(parseInt(element.value.trim()));
}
} else if (element.tagName === 'SELECT') {
isCompleted = element.value !== '' && element.options.length > 0 && !element.options[element.selectedIndex].disabled;
}

if (isCompleted) {
element.classList.add('completed');
} else {
element.classList.remove('completed');
}
}

/**
* Select Boxì— ë“œë¡­ë‹¤ìš´ ì•„ì´ì½˜ í‘œì‹œë¥¼ ì œì–´í•©ë‹ˆë‹¤.
* @param {HTMLElement} selectElement - Select í•„ë“œ ìš”ì†Œ.
*/
function toggleSelectArrow(selectElement) {
const selectBox = selectElement.parentElement;
if (!selectBox) return;

if (selectElement.value && selectElement.options.length > 0 && !selectElement.options[selectElement.selectedIndex].disabled) {
selectBox.classList.add('selected');
} else {
selectBox.classList.remove('selected');
}
}

carHangulSelect.addEventListener('change', function() {
toggleSelectArrow(this);
checkCompletion(this);
});

// ğŸ”´ í•µì‹¬ ìˆ˜ì •: ë°ì´í„° ì „ì†¡ ì „ ì½˜ì†” ë¡œê·¸ ì¶”ê°€
document.getElementById('carForm').addEventListener('submit', function(event) {
Â Â Â Â // ğŸš€ 1. ìœ íš¨ì„± ê²€ì‚¬ ì‹¤í–‰ (1ë‹¨ê³„ ê°€ê²© ê²€ì‚¬)
Â Â Â Â if (!validateStep1(true)) {
Â Â Â Â Â Â Â Â updateStep(1);
Â Â Â Â Â Â Â Â alert('1ë‹¨ê³„ í¬ë§ê°€ê²©ì„ ë¨¼ì € ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.');
Â Â Â Â Â Â Â Â event.preventDefault();
Â Â Â Â Â Â Â Â return;
Â Â Â Â }

Â Â Â Â // ğŸš€ 2. ìœ íš¨ì„± ê²€ì‚¬ ì‹¤í–‰ (2ë‹¨ê³„ ì—°ë½ì²˜/ì°¨ëŸ‰ë²ˆí˜¸/ë™ì˜ ê²€ì‚¬)
Â Â Â Â if (!validateStep2(true)) {
Â Â Â Â Â Â Â Â updateStep(2);
Â Â Â Â Â Â Â Â event.preventDefault();
Â Â Â Â Â Â Â Â return;
Â Â Â Â }


Â Â Â Â // ğŸš€ 3. ëª¨ë“  ê²€ì‚¬ í†µê³¼ í›„, ì „ì†¡ ì§ì „ì— Hidden í•„ë“œì— ìµœì¢… ê°’ ì„¤ì •
Â Â Â Â // 3-1. í¬ë§ê°€ê²© Hidden í•„ë“œ ê°’ ì„¤ì • (1ì–µ [ìˆ«ì]ë§Œì› í˜•ì‹)
Â Â Â Â licensePriceHidden.value = `1ì–µ ${licensePriceInput.value.trim()}ë§Œì›`;

Â Â Â Â // 3-2. ì°¨ëŸ‰ë²ˆí˜¸ Hidden í•„ë“œ ê°’ ì„¤ì • (ì„œìš¸[2ìë¦¬][í•œê¸€][4ìë¦¬] í˜•ì‹)
Â Â Â Â const part1Value = carNumPart1.value.trim();
Â Â Â Â const part2Value = carNumPart2.value.trim();
Â Â Â Â const hangulValue = carHangulSelect.value;
Â Â Â Â carNumberHidden.value = `ì„œìš¸${part1Value}${hangulValue}${part2Value}`;

Â Â Â Â // 3-3. ì „í™”ë²ˆí˜¸ Hidden í•„ë“œ ê°’ ì„¤ì • (010-[4ìë¦¬]-[4ìë¦¬] í˜•ì‹)
Â Â Â Â const phoneValue = phoneInput.value.replace(/[^0-9]/g, '');
Â Â Â Â phoneHidden.value = '010-' + phoneValue.slice(0, 4) + '-' + phoneValue.slice(4);

Â Â Â Â // 3-4. ê°œì¸ì •ë³´ ë™ì˜ Hidden í•„ë“œ ê°’ ì„¤ì •
Â Â Â Â consentHidden.value = consentCheckbox.checked ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤';
Â Â Â Â 
    // ğŸ”´ ì½˜ì†” ë¡œê·¸ ì¶œë ¥: Hidden í•„ë“œì— ì €ì¥ëœ ìµœì¢… ë°ì´í„° í™•ì¸
    console.log("--- ğŸš€ Google Forms ì „ì†¡ ë°ì´í„° í™•ì¸ ğŸš€ ---");
    console.log("1. í¬ë§ê°€ê²© (licensePriceHidden):", licensePriceHidden.value);
    console.log("2. ì„±í•¨ (name):", nameInput.value.trim()); // nameì€ ì¼ë°˜ í•„ë“œ
    console.log("3. ì „í™”ë²ˆí˜¸ (phoneHidden):", phoneHidden.value);
    console.log("4. ì°¨ëŸ‰ë²ˆí˜¸ (carNumberHidden):", carNumberHidden.value);
    console.log("5. ê°œì¸ì •ë³´ ë™ì˜ (consentHidden):", consentHidden.value);
    console.log("---------------------------------------");

Â Â Â Â // 4. ìµœì¢… ì œì¶œ
Â Â Â Â submitted = true; // ì œì¶œ ì‹œì‘ í”Œë˜ê·¸ ì„¤ì •
});

function updateStep(step) {
// ... (ë‹¨ê³„ ì´ë™ ë¡œì§) ...
}
function nextStep(step) {
// ... (ë‹¤ìŒ ë‹¨ê³„ ì´ë™ ë¡œì§) ...
}
function prevStep(step) {
// ... (ì´ì „ ë‹¨ê³„ ì´ë™ ë¡œì§) ...
}
function validateStep1(isSubmit = false) {
// ... (1ë‹¨ê³„ ìœ íš¨ì„± ê²€ì‚¬ ë¡œì§) ...
}
function validateStep2(isSubmit = false) {
// ... (2ë‹¨ê³„ ìœ íš¨ì„± ê²€ì‚¬ ë¡œì§) ...
}
// ... (ì…ë ¥ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë° ì´ˆê¸°í™” ë¡œì§) ...
// ************************************************************
// ì…ë ¥ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì¶”ê°€: ë°°ê²½ìƒ‰ ì²´í¬ ë° ì •ë ¬
// ************************************************************
const inputFields = document.querySelectorAll('.data-input-field');
const selectFields = document.querySelectorAll('.select-field');

inputFields.forEach(input => {
input.addEventListener('input', function() { checkCompletion(this); });
input.addEventListener('change', function() { checkCompletion(this); });
// blur ì‹œì—ë§Œ ë°°ê²½ìƒ‰ì„ ìµœì¢…ì ìœ¼ë¡œ ê²°ì •í•˜ê³  í°íŠ¸ í¬ê¸°ë¥¼ ë³µì›
input.addEventListener('blur', function() {
checkCompletion(this);
// blur ì‹œì— ë‹ë³´ê¸° íš¨ê³¼ í•´ì œì— í•„ìš”í•œ ìŠ¤íƒ€ì¼ ë³µì› (CSSì—ì„œ .completed í´ë˜ìŠ¤ê°€ ì²˜ë¦¬)
this.style.fontSize = '';
this.style.padding = '';
this.style.height = '';
this.style.lineHeight = '';
this.style.fontWeight = '';
this.style.boxShadow = '';
});
});

selectFields.forEach(select => {
select.addEventListener('change', function() { checkCompletion(this); toggleSelectArrow(this); });
// blur ì‹œì—ë§Œ ë°°ê²½ìƒ‰ì„ ìµœì¢…ì ìœ¼ë¡œ ê²°ì •í•˜ê³  í°íŠ¸ í¬ê¸°ë¥¼ ë³µì›
select.addEventListener('blur', function() {
checkCompletion(this);
// blur ì‹œì— ë‹ë³´ê¸° íš¨ê³¼ í•´ì œì— í•„ìš”í•œ ìŠ¤íƒ€ì¼ ë³µì› (CSSì—ì„œ .completed í´ë˜ìŠ¤ê°€ ì²˜ë¦¬)
this.style.fontSize = '';
this.style.padding = '';
this.style.height = '';
this.style.lineHeight = '';
this.style.fontWeight = '';
this.style.boxShadow = '';
});
});

// ì „í™”ë²ˆí˜¸ í˜•ì‹ ì§€ì •
phoneInput.addEventListener('input', function(e) {
let value = e.target.value.replace(/[^0-9]/g, '');
if (value.length > 8) { value = value.slice(0, 8); }
let result = '';
if (value.length <= 4) { result = value; }
else { result = value.slice(0, 4) + '-' + value.slice(4); }
e.target.value = result;
checkCompletion(e.target);
});

carNumPart1.addEventListener('input', function(e) {
e.target.value = e.target.value.replace(/[^0-9]/g, '').slice(0, 2);
checkCompletion(e.target);
});

carNumPart2.addEventListener('input', function(e) {
e.target.value = e.target.value.replace(/[^0-9]/g, '').slice(0, 4);
checkCompletion(e.target);
});

// ë©´í—ˆ í¬ë§ê°€ê²© ì…ë ¥ (ìˆ«ìë§Œ/ê¸¸ì´ ì œí•œ 4ìë¦¬ë¡œ ìˆ˜ì •)
licensePriceInput.addEventListener('input', function(e) {
e.target.value = e.target.value.replace(/[^0-9]/g, '').slice(0, 4);
checkCompletion(e.target);
});

document.addEventListener('DOMContentLoaded', function() {
updateStep(1);
// ì´ˆê¸° ë¡œë”© ì‹œ ëª¨ë“  í•„ë“œì˜ ì™„ë£Œ ìƒíƒœë¥¼ í™•ì¸í•˜ì—¬ ë°°ê²½ìƒ‰ì„ ì„¤ì •í•©ë‹ˆë‹¤.
document.querySelectorAll('.data-input-field, .select-field').forEach(element => {
checkCompletion(element);
if (element.tagName === 'SELECT') {
toggleSelectArrow(element);
}
});
});
</script>
</body>
</html>
